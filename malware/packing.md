[Home](https://github.com/jplowri0/Blog/blob/main/home.md) / [Static Analysis](https://github.com/jplowri0/Blog/blob/main/malware/Static_Analysis.md) 

# Packing 
## About
- If packed then in UPX Utility in CFF we'll have an option to unpack. If not packed then that button will be greyed out. And have the option to pack it. 
- Most use UPX to pack. 
- PEID will also tell us this. 
*  PEiD will also compute an Entropy. If greater than 7, that suggest packing / compression / encryption 
- In CFF click Unpack  
- Can also manually extract with 7zip. 
- in CFF can also save the unpacked version. 
- Strings - the alphabet can be shifted

## Tools
- UPX (remnux)
- CFF Explorer > UPX Utility 
- PEID 
- 7Zip

## Process
### UPX Utiltiy 
On Remnux, we can run the command:
```
upx -d FILENAME.exe
```
which should allow us to unpack. 

### PEID
- In PEID we can open the file and perform a Hardcore scan
-  > Hardcore Scan 

![hey](https://github.com/jplowri0/Blog/blob/main/malware/Packing1.png)

- Select >> >> 
- Then Select "-" beside Entropy / EP Check / Fast Check 
- If Entropy 7 or above. Could be packed. 

![hey](https://github.com/jplowri0/Blog/blob/main/malware/Packing2.png)

### CFF Explorer
- If packed: In CFF, we'll see in Resource Editor we wil be unable to view any of the Icons  (only a few will be visisble)
- In [[Section Headers]] there may be NO text or data sections 
-  In CFF Go to UPX Utilily Check if we can select unpack 

![hey](https://github.com/jplowri0/Blog/blob/main/malware/Packing3.png)

- in .rcrs section we should now be able to see icons in Resource Editor and the / .text / .data [[Section Headers]]
- Now since it has been unpacked, in CFF Explorer goto FIle > Save As  (MALWARE UNPACKED)
- WIth the new Sample we can now unzip in 7zip. We can now see all te detials. 

## Bloated with 0's?
https://twitter.com/struppigel/status/1555073215592075265?s=21&t=ctxsaLyLCmMy3s3zIUrz0Q

## Unpacking
https://youtu.be/V1k-6_LiSKw using x32dbg

